{
  "entities": {
    "CuppingSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CuppingSession",
      "type": "object",
      "description": "Represents a cupping session, which is a collection of cupping evaluations.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the CuppingSession entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the cupping session."
        },
        "description": {
          "type": "string",
          "description": "Description of the cupping session."
        },
        "date": {
          "type": "string",
          "description": "Date of the cupping session.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "date"
      ]
    },
    "Evaluation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Evaluation",
      "type": "object",
      "description": "Represents a single coffee evaluation.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Evaluation entity."
        },
        "coffeeName": {
          "type": "string"
        },
        "roastLevel": {
          "type": "string",
          "enum": ["light", "medium", "medium-dark", "dark"]
        },
        "cups": {
          "type": "array"
        },
        "overallScore": {
          "type": "number"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "userId": {
          "type": "string"
        },
        "isFavorite": {
          "type": "boolean"
        }
      },
      "required": [
        "id",
        "coffeeName",
        "roastLevel",
        "cups",
        "overallScore",
        "createdAt",
        "userId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/evaluations/{evaluationId}",
        "definition": {
          "entityName": "Evaluation",
          "schema": {
            "$ref": "#/backend/entities/Evaluation"
          },
          "description": "Stores coffee evaluation data, owned by the user.",
          "params": [
            {
              "name": "userId",
              "description": "The ID of the user who owns the evaluation."
            },
            {
              "name": "evaluationId",
              "description": "The ID of the evaluation."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage coffee evaluations. Each user owns their evaluations. Authorization independence is achieved by structuring data around user-owned documents, eliminating the need for `get()` calls in security rules. List operations are secured via path-based ownership, ensuring users can only access resources they own.\n\nSpecifically, Evaluations are stored under `/users/{userId}/evaluations/{evaluationId}`, ensuring that only the owning user can access or modify these evaluations. This hierarchical structure facilitates simple and secure security rules based on the `request.auth.uid` and prevents unauthorized data access."
  }
}
